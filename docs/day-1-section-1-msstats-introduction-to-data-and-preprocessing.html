<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 1 Day 1 - Section 1 : MSstats, introduction to data and preprocessing | May Institute 2019: Statistics for quantitative mass spsectrometry</title>
  <meta name="description" content="Chapter 1 Day 1 - Section 1 : MSstats, introduction to data and preprocessing | May Institute 2019: Statistics for quantitative mass spsectrometry">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 1 Day 1 - Section 1 : MSstats, introduction to data and preprocessing | May Institute 2019: Statistics for quantitative mass spsectrometry" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Day 1 - Section 1 : MSstats, introduction to data and preprocessing | May Institute 2019: Statistics for quantitative mass spsectrometry" />
  
  
  

<meta name="author" content="Meena Choi and Ting Huang">


<meta name="date" content="2019-05-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Before we start</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#suggested-reading"><i class="fa fa-check"></i>Suggested reading</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><i class="fa fa-check"></i><b>1</b> Day 1 - Section 1 : MSstats, introduction to data and preprocessing</a><ul>
<li class="chapter" data-level="1.1" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#objective"><i class="fa fa-check"></i><b>1.1</b> Objective</a></li>
<li class="chapter" data-level="1.2" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#workflow-in-msstats"><i class="fa fa-check"></i><b>1.2</b> Workflow in MSstats</a></li>
<li class="chapter" data-level="1.3" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#data"><i class="fa fa-check"></i><b>1.3</b> Data</a></li>
<li class="chapter" data-level="1.4" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#load-msstats"><i class="fa fa-check"></i><b>1.4</b> Load MSstats</a></li>
<li class="chapter" data-level="1.5" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#allowable-data-formats"><i class="fa fa-check"></i><b>1.5</b> Allowable data formats</a></li>
<li class="chapter" data-level="1.6" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#convert-to-msstats-required-format-data-cleaning"><i class="fa fa-check"></i><b>1.6</b> Convert to MSstats required format (Data cleaning)</a><ul>
<li class="chapter" data-level="1.6.1" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#skyline-output"><i class="fa fa-check"></i><b>1.6.1</b> Skyline output</a></li>
<li class="chapter" data-level="1.6.2" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#maxquant-output"><i class="fa fa-check"></i><b>1.6.2</b> MaxQuant output</a></li>
<li class="chapter" data-level="1.6.3" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#openms-output"><i class="fa fa-check"></i><b>1.6.3</b> OpenMS output</a></li>
<li class="chapter" data-level="1.6.4" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#progenesis-output"><i class="fa fa-check"></i><b>1.6.4</b> Progenesis output</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#save-your-work"><i class="fa fa-check"></i><b>1.7</b> Save your work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><i class="fa fa-check"></i><b>2</b> Day 1 - Section 2 : MSstats, Data processing - Normalization and run summarization</a><ul>
<li class="chapter" data-level="2.1" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#data-1"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-skyline-data"><i class="fa fa-check"></i><b>2.2</b> dataProcess with Skyline data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#load-msstats-1"><i class="fa fa-check"></i><b>2.2.1</b> Load MSstats</a></li>
<li class="chapter" data-level="2.2.2" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#load-the-pre-processed-data-of-skyline-output"><i class="fa fa-check"></i><b>2.2.2</b> Load the pre-processed data of Skyline output</a></li>
<li class="chapter" data-level="2.2.3" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#normalizing-and-summarizing-data-with-dataprocess"><i class="fa fa-check"></i><b>2.2.3</b> Normalizing and summarizing data with dataProcess</a></li>
<li class="chapter" data-level="2.2.4" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#visualization-of-processed-data"><i class="fa fa-check"></i><b>2.2.4</b> Visualization of processed data</a></li>
<li class="chapter" data-level="2.2.5" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#different-normalization-option"><i class="fa fa-check"></i><b>2.2.5</b> Different normalization option</a></li>
<li class="chapter" data-level="2.2.6" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#different-summarization-option"><i class="fa fa-check"></i><b>2.2.6</b> Different summarization option</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-maxquant-data"><i class="fa fa-check"></i><b>2.3</b> dataProcess with MaxQuant data</a></li>
<li class="chapter" data-level="2.4" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-openms-data"><i class="fa fa-check"></i><b>2.4</b> dataProcess with OpenMS data</a></li>
<li class="chapter" data-level="2.5" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-progenesis-data"><i class="fa fa-check"></i><b>2.5</b> dataProcess with Progenesis data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><i class="fa fa-check"></i><b>3</b> Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation</a><ul>
<li class="chapter" data-level="3.1" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#summary"><i class="fa fa-check"></i><b>3.1</b> Summary</a></li>
<li class="chapter" data-level="3.2" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#data-2"><i class="fa fa-check"></i><b>3.2</b> Data</a></li>
<li class="chapter" data-level="3.3" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#load-msstats-2"><i class="fa fa-check"></i><b>3.3</b> Load MSstats</a></li>
<li class="chapter" data-level="3.4" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#inference-and-future-design-of-experiment-with-skyline-output"><i class="fa fa-check"></i><b>3.4</b> Inference and future design of experiment with Skyline output</a><ul>
<li class="chapter" data-level="3.4.1" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#load-the-processed-data-output-of-dataprocess-of-skyline-output"><i class="fa fa-check"></i><b>3.4.1</b> Load the processed data (output of <code>dataProcess</code>) of Skyline output</a></li>
<li class="chapter" data-level="3.4.2" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#finding-differentially-abundant-proteins-across-conditions"><i class="fa fa-check"></i><b>3.4.2</b> Finding differentially abundant proteins across conditions</a></li>
<li class="chapter" data-level="3.4.3" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#visualization-of-differentially-abundant-proteins"><i class="fa fa-check"></i><b>3.4.3</b> Visualization of differentially abundant proteins</a></li>
<li class="chapter" data-level="3.4.4" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#planning-future-experimental-designs"><i class="fa fa-check"></i><b>3.4.4</b> Planning future experimental designs</a></li>
<li class="chapter" data-level="3.4.5" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#protein-subject-quantification"><i class="fa fa-check"></i><b>3.4.5</b> Protein subject quantification</a></li>
<li class="chapter" data-level="3.4.6" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#msstats.log-and-sessioninfo.txt"><i class="fa fa-check"></i><b>3.4.6</b> msstats.log and sessionInfo.txt</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#inference-and-future-design-of-experiment-with-skyline-output-1"><i class="fa fa-check"></i><b>3.5</b> Inference and future design of experiment with Skyline output</a></li>
<li class="chapter" data-level="3.6" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#inference-and-future-design-of-experiment-with-openms-output"><i class="fa fa-check"></i><b>3.6</b> Inference and future design of experiment with OpenMS output</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">May Institute 2019: Statistics for quantitative mass spsectrometry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-1---section-1-msstats-introduction-to-data-and-preprocessing" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Day 1 - Section 1 : MSstats, introduction to data and preprocessing</h1>
<div id="objective" class="section level2">
<h2><span class="header-section-number">1.1</span> Objective</h2>
<ul>
<li>Preprocessing steps to make required input format for MSstats from output from diverse output of spectral processing tools.</li>
<li>Make annotation file, based on experimental design.</li>
</ul>
<hr />
</div>
<div id="workflow-in-msstats" class="section level2">
<h2><span class="header-section-number">1.2</span> Workflow in MSstats</h2>
<p><img src="img/MSstats_intro1.png" /></p>
<p><img src="img/MSstats_intro2.png" />
<img src="img/MSstats_intro3.png" /></p>
<hr />
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">1.3</span> Data</h2>
<ul>
<li>the quantified peak intensities data from ABRF 2015, processed by Skyline.</li>
</ul>
<div class="figure">
<img src="img/Protein_sample_information.png" alt="Summary of the ABRF 2015 study design, Choi, et al. J Proteome Res. 2017" style="width:70.0%" />
<p class="caption">Summary of the ABRF 2015 study design, Choi, et al. J Proteome Res. 2017</p>
</div>
<hr />
</div>
<div id="load-msstats" class="section level2">
<h2><span class="header-section-number">1.4</span> Load MSstats</h2>
<p>Load MSstats first. Then you are ready to start MSstats.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MSstats)
?MSstats</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;ggplot2&#39;:
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang</code></pre>
<hr />
</div>
<div id="allowable-data-formats" class="section level2">
<h2><span class="header-section-number">1.5</span> Allowable data formats</h2>
<p><code>MSstats</code> performs statistical analysis steps, that follow peak identification and quantitation. Therefore, input
to MSstats is the output of other software tools (such as <code>Skyline</code>, <code>MaxQuant</code> and so on) that read raw spectral files
, identify and quantify spectral peaks. The preferred structure of data for use in MSstats is a .csv file
in a <em>long</em> format with at least 10 columns representing the following variables: <strong>ProteinName</strong>, <strong>PeptideSequence</strong>, <strong>PrecursorCharge</strong>, <strong>FragmentIon</strong>, <strong>ProductCharge</strong>, <strong>IsotopeLabelType</strong>, <strong>Condition</strong>, <strong>BioReplicate</strong>, <strong>Run</strong>, <strong>Intensity</strong>. The variable names are fixed, but are case-insensitive.</p>
<pre><code>##   ProteinName PeptideSequence PrecursorCharge FragmentIon ProductCharge
## 1      bovine     S.PVDIDTK_5               5          NA            NA
## 2      bovine     S.PVDIDTK_5               5          NA            NA
## 3      bovine     S.PVDIDTK_5               5          NA            NA
## 4      bovine     S.PVDIDTK_5               5          NA            NA
## 5      bovine     S.PVDIDTK_5               5          NA            NA
## 6      bovine     S.PVDIDTK_5               5          NA            NA
##   IsotopeLabelType Condition BioReplicate Run Intensity
## 1                L        C1            1   1   2636792
## 2                L        C1            1   2   1992418
## 3                L        C1            1   3   1982146
## 4                L        C2            1   4   5019594
## 5                L        C2            1   5   4560468
## 6                L        C2            1   6   3627849</code></pre>
<hr />
</div>
<div id="convert-to-msstats-required-format-data-cleaning" class="section level2">
<h2><span class="header-section-number">1.6</span> Convert to MSstats required format (Data cleaning)</h2>
<hr />
<p>Let’s start preprocessing steps to make required input format for MSstats from output from diverse output of spectral processing tools.</p>
<p><img src="img/MSstats_intro4.png" /></p>
<ul>
<li><p>Data input support for various data acquisition methods : DDA, DIA, SRM</p></li>
<li><p>Interoperability with existing computational tools :
- Converter functions for 7 data processin tools :
<code>SkylinetoMSstatsFormat</code>, <code>MaxQtoMSstatsFormat</code>, <code>OpenMStoMSstatsFormat</code>, <code>ProgenesistoMSstatsFormat</code>, <code>PDtoMSstatsFormat</code>, <code>SpectronauttoMSstatsFormat</code>, <code>OpenSWATHtoMSstatsFormat</code>, <code>DIAUmpiretoMSstatsFormat</code>
- Consistent data cleaning steps across converter functions : filter multiple measurements, shared peptides, etc.
- Generate the same format of data from diverse type of data format.</p></li>
</ul>
<div id="skyline-output" class="section level3">
<h3><span class="header-section-number">1.6.1</span> Skyline output</h3>
<div id="read-data" class="section level4">
<h4><span class="header-section-number">1.6.1.1</span> Read data</h4>
<p>The required input data is generated automatically when using <code>MSstats</code> report format in <code>Skyline</code>.
We first load and access the dataset processed by <code>Skyline</code>. The name of saved file from <code>Skyline</code> using <code>MSstats report format</code> is <em>‘ABRF2015_Skyline_report.csv’</em>. or you can use the published data from this link (<a href="https://panoramaweb.org/labkey/project/MacCoss/brendan/manuscripts/iPRG%202015/begin.view" class="uri">https://panoramaweb.org/labkey/project/MacCoss/brendan/manuscripts/iPRG%202015/begin.view</a>). This example dataset is the exactly same data in ‘iPRG_10ppm_2rt_15cut_nosingle.csv’ from the link above.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read output from skyline </span>
raw.skyline &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;data/data_Skyline/ABRF2015_Skyline_report.csv&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check the first 6 rows of dataset</span>
<span class="kw">head</span>(raw.skyline)</code></pre>
<pre><code>##                   ProteinName PeptideSequence PeptideModifiedSequence
## 1 DECOY_sp|P0CF18|YM085_YEAST      KDMYGNPFQK         KDM[+16]YGNPFQK
## 2 DECOY_sp|P0CF18|YM085_YEAST      KDMYGNPFQK         KDM[+16]YGNPFQK
## 3 DECOY_sp|P0CF18|YM085_YEAST      KDMYGNPFQK         KDM[+16]YGNPFQK
## 4 DECOY_sp|P0CF18|YM085_YEAST      KDMYGNPFQK         KDM[+16]YGNPFQK
## 5 DECOY_sp|P0CF18|YM085_YEAST      KDMYGNPFQK         KDM[+16]YGNPFQK
## 6 DECOY_sp|P0CF18|YM085_YEAST      KDMYGNPFQK         KDM[+16]YGNPFQK
##   PrecursorCharge PrecursorMz FragmentIon ProductCharge ProductMz
## 1               3    415.1974   precursor             3  415.1974
## 2               3    415.1974   precursor             3  415.1974
## 3               3    415.1974   precursor             3  415.1974
## 4               3    415.1974   precursor             3  415.1974
## 5               3    415.1974   precursor             3  415.1974
## 6               3    415.1974   precursor             3  415.1974
##   IsotopeLabelType Condition BioReplicate                  FileName
## 1            light        NA           NA JD_06232014_sample1_B.raw
## 2            light        NA           NA JD_06232014_sample1_C.raw
## 3            light        NA           NA JD_06232014_sample1-A.raw
## 4            light        NA           NA JD_06232014_sample2_A.raw
## 5            light        NA           NA JD_06232014_sample2_B.raw
## 6            light        NA           NA JD_06232014_sample2_C.raw
##      Area StandardType Truncated annotation_QValue
## 1  147327           NA     False                NA
## 2 1373397           NA     False                NA
## 3   71765           NA     False                NA
## 4   66387           NA     False                NA
## 5  107736           NA     False                NA
## 6  380812           NA     False                NA</code></pre>
<p>There are some column named differently than required input. The information for <code>Condition</code> and <code>BioReplicate</code> is missing. Let’s do preliminary check for this input.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># total number of unique protein name</span>
<span class="kw">length</span>(<span class="kw">unique</span>(raw.skyline<span class="op">$</span>Protein))</code></pre>
<pre><code>## [1] 3097</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># several isotopic peaks for peptide charge</span>
<span class="kw">unique</span>(raw.skyline<span class="op">$</span>FragmentIon)</code></pre>
<pre><code>## [1] precursor       precursor [M+1] precursor [M+2]
## Levels: precursor precursor [M+1] precursor [M+2]</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># unique FileName, which is MS run.</span>
<span class="kw">unique</span>(raw.skyline<span class="op">$</span>FileName)</code></pre>
<pre><code>##  [1] JD_06232014_sample1_B.raw JD_06232014_sample1_C.raw
##  [3] JD_06232014_sample1-A.raw JD_06232014_sample2_A.raw
##  [5] JD_06232014_sample2_B.raw JD_06232014_sample2_C.raw
##  [7] JD_06232014_sample3_A.raw JD_06232014_sample3_B.raw
##  [9] JD_06232014_sample3_C.raw JD_06232014_sample4_B.raw
## [11] JD_06232014_sample4_C.raw JD_06232014_sample4-A.raw
## 12 Levels: JD_06232014_sample1_B.raw ... JD_06232014_sample4-A.raw</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># &#39;Truncated&#39; column</span>
<span class="kw">unique</span>(raw.skyline<span class="op">$</span>Truncated)</code></pre>
<pre><code>## [1] False       True 
## Levels:  False True</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># count table for &#39;Truncated&#39; column</span>
<span class="kw">xtabs</span>(<span class="op">~</span>Truncated, raw.skyline)</code></pre>
<pre><code>## Truncated
##           False    True 
##     237 1256666     829</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># count which &#39;Truncated&#39; is &#39;True&#39;</span>
<span class="kw">sum</span>(raw.skyline<span class="op">$</span>Truncated <span class="op">==</span><span class="st"> &#39;True&#39;</span>)</code></pre>
<pre><code>## [1] 829</code></pre>
</div>
<div id="set-annotation-file" class="section level4">
<h4><span class="header-section-number">1.6.1.2</span> Set annotation file</h4>
<p>Annotation information is required to fill in <strong>Condition</strong> and <strong>BioReplicate</strong> for corresponding <strong>Run</strong> information. Users have to prepare as csv or txt file like ‘ABRF2015_Skyline_annotation.csv’, which includes <strong>Run</strong>, <strong>Condition</strong>, and <strong>BioReplicate</strong> information, and load it in R.</p>
<pre class="sourceCode r"><code class="sourceCode r">annot.skyline &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;data/data_Skyline/ABRF2015_Skyline_annotation.csv&quot;</span>)
annot.skyline</code></pre>
<pre><code>##                          Run  Condition BioReplicate
## 1  JD_06232014_sample1-A.raw Condition1            1
## 2  JD_06232014_sample2_A.raw Condition2            2
## 3  JD_06232014_sample4_B.raw Condition4            4
## 4  JD_06232014_sample1_B.raw Condition1            1
## 5  JD_06232014_sample1_C.raw Condition1            1
## 6  JD_06232014_sample2_B.raw Condition2            2
## 7  JD_06232014_sample2_C.raw Condition2            2
## 8  JD_06232014_sample3_A.raw Condition3            3
## 9  JD_06232014_sample3_B.raw Condition3            3
## 10 JD_06232014_sample3_C.raw Condition3            3
## 11 JD_06232014_sample4-A.raw Condition4            4
## 12 JD_06232014_sample4_C.raw Condition4            4</code></pre>
<div id="common-mistake-for-annotation-file-incorrect-run-information" class="section level5">
<h5><span class="header-section-number">1.6.1.2.1</span> Common mistake for annotation file : Incorrect Run information</h5>
<p>Raw file name in the output of spectral processing tool is commonly long. We can make a typo in annotation file. If Raw file name and Run information are not matched,</p>
<p>Let’s check whether <strong>Run</strong> information is same as <strong>File.Name</strong> in output of <code>Skyline</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setdiff</span>(<span class="kw">unique</span>(raw.skyline<span class="op">$</span>FileName), annot.skyline<span class="op">$</span>Run)</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setdiff</span>(annot.skyline<span class="op">$</span>Run, <span class="kw">unique</span>(raw.skyline<span class="op">$</span>FileName))</code></pre>
<pre><code>## character(0)</code></pre>
<p>There is no issue in this annotation.</p>
<p>Let’s try the example with unmatched information.</p>
<pre class="sourceCode r"><code class="sourceCode r">annot.wrong &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;data/data_Skyline/ABRF2015_Skyline_annotation_wrong_example.csv&quot;</span>)
annot.wrong</code></pre>
<pre><code>##                          Run  Condition BioReplicate
## 1  JD_06232014_sample1_A.raw Condition1            1
## 2  JD_06232014_sample2_A.raw Condition2            2
## 3  JD_06232014_sample4_B.raw Condition4            4
## 4  JD_06232014_sample1_B.raw Condition1            1
## 5  JD_06232014_sample1_C.raw Condition1            1
## 6  JD_06232014_sample2_B.raw Condition2            2
## 7  JD_06232014_sample2_C.raw Condition2            2
## 8  JD_06232014_sample3_A.raw Condition3            3
## 9  JD_06232014_sample3_B.raw Condition3            3
## 10 JD_06232014_sample3_C.raw Condition3            3
## 11 JD_06232014_sample4-A.raw Condition4            4
## 12 JD_06232014_sample4_C.raw Condition4            4</code></pre>
<p><strong>Note!</strong> small details : hyphen vs underline.</p>
</div>
<div id="common-mistake-for-annotation-file-incorrect-bioreplicate-information" class="section level5">
<h5><span class="header-section-number">1.6.1.2.2</span> Common mistake for annotation file : Incorrect <code>BioReplicate</code> information</h5>
<p><code>MSstats</code> distinguish the design of experiment as group comparison, time course, paired design, with the combination of <code>Condition</code>, <code>BioReplicate</code>, and <code>Run</code>.</p>
<div id="group-comparison" class="section level6">
<h6><span class="header-section-number">1.6.1.2.2.1</span> Group comparison</h6>
<p><img src="img/expdesign_group.png" style="width:40.0%" /></p>
<p>In a group comparison design, the conditions (e.g., disease states) are profiled across <strong>non-overlapping sets of biological replicates (i.e., subjects)</strong>. In this example there are 2 conditions, Disease and Control (in general the number of conditions can vary). There are 3 subjects (i.e., biological replicates) per condition (in general an equal number of replicates per condition is not required). Overall, in this example there are 2 × 3 = 6 mass spectrometry runs.</p>
<p>The most important is that 1) subject IDs for disease group are completely different thatn subject IDs for control group 2) <code>Run</code> is not order of spectral acquisition, but just unique MS run ID.</p>
<p><img src="img/expdesign_group_tech.png" /></p>
<p>In addition, if each subject has e technical replicate runs (in general technical replicates are not required, and their number per sample may vary). there are 2 × 3 × 3 = 18 mass spectrometry runs.</p>
</div>
<div id="time-course" class="section level6">
<h6><span class="header-section-number">1.6.1.2.2.2</span> Time course</h6>
<p>The important feature of a time course experimental design is that <strong>a same subject (i.e., biological replicate) is repetitively measured across multiple time points</strong>. In this example there are 3 time points, Time1, Time2, and Time3 (in general the number of times can vary). There are 3 subjects (i.e., biological replicates) measured across times (in general an equal number of times per replicate is not required). There are no technical replicates (in general the number of technical replicates per sample may vary). Overall, in this example there are 3 × 3 = 9 mass spectrometry runs.</p>
<p><img src="img/expdesign_time.png" style="width:60.0%" /></p>
</div>
<div id="paired-design" class="section level6">
<h6><span class="header-section-number">1.6.1.2.2.3</span> Paired design</h6>
<p>Another frequently used experimental design is a <em>paired design</em>, where measurements from <strong>multiple conditions (such as healthy biopsy and disease biopsy) are taken from a same subject</strong>. The statistical model for this experimental design is the same as in the time course experiment, however the values in the columns of the input data may have a different appearence. In this example there are 3 subjects (in general the number of patients can vary). There are three conditions per subject (in general the number of conditions per subject can exceed two). Overall, in this example there are <span class="math inline">\(2 \times 3 = 6\)</span> mass spectrometry runs. <code>BioReplicate</code> should indicate each individual ID.</p>
<p><img src="img/expdesign_pair.png" style="width:60.0%" /></p>
</div>
</div>
</div>
<div id="preprocessing-with-skylinetomsstatsformat" class="section level4">
<h4><span class="header-section-number">1.6.1.3</span> Preprocessing with <code>SkylinetoMSstatsFormat</code></h4>
<p>The input data for <code>MSstats</code> is required to contain variables of <strong>ProteinName</strong>, <strong>PeptideSequence</strong>, <strong>PrecursorCharge</strong>, <strong>FragmentIon</strong>, <strong>ProductCharge</strong>, <strong>IsotopeLabelType</strong>, <strong>Condition</strong>, <strong>BioReplicate</strong>, <strong>Run</strong>, <strong>Intensity</strong>. These variable names should be fixed. <code>MSstats</code> input from Skyline adapts the column scheme of the dataset so that it fits <code>MSstats</code> input format. However there are several extra column names and also some of them need to be changed. <code>SkylinetoMSstatsFormat</code> function helps pre-processing for making right format of MSstats input from Skyline output. For example, it renames some column name, and replace truncated peak intensities with NA. Another important step is to handle isotopic peaks before using <code>dataProcess</code>. The output from Skyline for DDA experiment has several measurements of peak area from the monoisotopic, M+1 and M+2 peaks. To get a robust measure of peptide intensity, we can sum over isotopic peaks per peptide or use the highest peak. Here we take a summation per peptide ion.</p>
<p>Here is the summary of pre-processing steps in <code>SkylinetoMSstatsFormat</code> function (in orange box below).</p>
<p><img src="img/MSstats_Skyline.png" /></p>
<p>For further details, visit the help file using the following code.</p>
<pre class="sourceCode r"><code class="sourceCode r">?SkylinetoMSstatsFormat</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># reformating and pre-processing for Skyline output.</span>
input.skyline &lt;-<span class="st"> </span><span class="kw">SkylinetoMSstatsFormat</span>(raw.skyline, 
                                        <span class="dt">annotation=</span>annot.skyline,
                                        <span class="dt">removeProtein_with1Feature =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## ** Proteins, which names include DECOY, are removed.</code></pre>
<pre><code>## ** Peptides, that are used in more than one proteins, are removed.</code></pre>
<pre><code>## Warning in SkylinetoMSstatsFormat(raw.skyline, annotation =
## annot.skyline, : NAs introduced by coercion</code></pre>
<pre><code>## ** Truncated peaks are replaced with NA.</code></pre>
<pre><code>## ** For DDA datasets, three isotopic peaks per feature and run are summed.</code></pre>
<pre><code>## ** 4 features have all NAs or zero intensity values and are removed.</code></pre>
<pre><code>## ** 13 features have 1 or 2 intensities across runs and are removed.</code></pre>
<pre><code>## ** All proteins have at least two features.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(input.skyline)</code></pre>
<pre><code>##            ProteinName             PeptideSequence PrecursorCharge
## 1 sp|D6VTK4|STE2_YEAST EGEVEPVDM[+16]YTPDTAADEEARK               3
## 2 sp|D6VTK4|STE2_YEAST EGEVEPVDM[+16]YTPDTAADEEARK               3
## 3 sp|D6VTK4|STE2_YEAST EGEVEPVDM[+16]YTPDTAADEEARK               3
## 4 sp|D6VTK4|STE2_YEAST EGEVEPVDM[+16]YTPDTAADEEARK               3
## 5 sp|D6VTK4|STE2_YEAST EGEVEPVDM[+16]YTPDTAADEEARK               3
## 6 sp|D6VTK4|STE2_YEAST EGEVEPVDM[+16]YTPDTAADEEARK               3
##   FragmentIon ProductCharge IsotopeLabelType  Condition BioReplicate
## 1         sum            NA                L Condition1            1
## 2         sum            NA                L Condition2            2
## 3         sum            NA                L Condition4            4
## 4         sum            NA                L Condition2            2
## 5         sum            NA                L Condition4            4
## 6         sum            NA                L Condition3            3
##                         Run Intensity StandardType
## 1 JD_06232014_sample1_C.raw   7863713           NA
## 2 JD_06232014_sample2_A.raw    977615           NA
## 3 JD_06232014_sample4_B.raw   4102785           NA
## 4 JD_06232014_sample2_C.raw   6547299           NA
## 5 JD_06232014_sample4_C.raw   3972464           NA
## 6 JD_06232014_sample3_B.raw   8896052           NA</code></pre>
</div>
<div id="preliminary-check" class="section level4">
<h4><span class="header-section-number">1.6.1.4</span> Preliminary check</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(input.skyline<span class="op">$</span>ProteinName)) </code></pre>
<pre><code>## [1] 3027</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(input.skyline<span class="op">$</span>Intensity)) </code></pre>
<pre><code>## [1] 219</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(input.skyline<span class="op">$</span>Intensity) <span class="op">&amp;</span><span class="st"> </span>input.skyline<span class="op">$</span>Intensity<span class="op">==</span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 2414</code></pre>
<hr />
</div>
</div>
<div id="maxquant-output" class="section level3">
<h3><span class="header-section-number">1.6.2</span> MaxQuant output</h3>
<div id="read-data-1" class="section level4">
<h4><span class="header-section-number">1.6.2.1</span> Read data</h4>
<p>Three files should be prepared before MSstats. Two files, ‘proteinGroups.txt’ and ‘evidence.txt’ are outputs
from MaxQuant.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, get protein ID information</span>
proteinGroups &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/data_MaxQuant/proteinGroups.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in MaxQuant file: evidence.txt</span>
evi &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/data_MaxQuant/evidence.txt&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
<span class="kw">colnames</span>(evi)</code></pre>
<pre><code>##  [1] &quot;Sequence&quot;                           
##  [2] &quot;Length&quot;                             
##  [3] &quot;Modifications&quot;                      
##  [4] &quot;Modified.sequence&quot;                  
##  [5] &quot;Oxidation..M..Probabilities&quot;        
##  [6] &quot;Oxidation..M..Score.Diffs&quot;          
##  [7] &quot;Acetyl..Protein.N.term.&quot;            
##  [8] &quot;Oxidation..M.&quot;                      
##  [9] &quot;Missed.cleavages&quot;                   
## [10] &quot;Proteins&quot;                           
## [11] &quot;Leading.proteins&quot;                   
## [12] &quot;Leading.razor.protein&quot;              
## [13] &quot;Gene.names&quot;                         
## [14] &quot;Protein.names&quot;                      
## [15] &quot;Type&quot;                               
## [16] &quot;Raw.file&quot;                           
## [17] &quot;MS.MS.m.z&quot;                          
## [18] &quot;Charge&quot;                             
## [19] &quot;m.z&quot;                                
## [20] &quot;Mass&quot;                               
## [21] &quot;Resolution&quot;                         
## [22] &quot;Uncalibrated...Calibrated.m.z..ppm.&quot;
## [23] &quot;Uncalibrated...Calibrated.m.z..Da.&quot; 
## [24] &quot;Mass.Error..ppm.&quot;                   
## [25] &quot;Mass.Error..Da.&quot;                    
## [26] &quot;Uncalibrated.Mass.Error..ppm.&quot;      
## [27] &quot;Uncalibrated.Mass.Error..Da.&quot;       
## [28] &quot;Max.intensity.m.z.0&quot;                
## [29] &quot;Retention.time&quot;                     
## [30] &quot;Retention.length&quot;                   
## [31] &quot;Calibrated.retention.time&quot;          
## [32] &quot;Calibrated.retention.time.start&quot;    
## [33] &quot;Calibrated.retention.time.finish&quot;   
## [34] &quot;Retention.time.calibration&quot;         
## [35] &quot;Match.time.difference&quot;              
## [36] &quot;Match.m.z.difference&quot;               
## [37] &quot;Match.q.value&quot;                      
## [38] &quot;Match.score&quot;                        
## [39] &quot;Number.of.data.points&quot;              
## [40] &quot;Number.of.scans&quot;                    
## [41] &quot;Number.of.isotopic.peaks&quot;           
## [42] &quot;PIF&quot;                                
## [43] &quot;Fraction.of.total.spectrum&quot;         
## [44] &quot;Base.peak.fraction&quot;                 
## [45] &quot;PEP&quot;                                
## [46] &quot;MS.MS.Count&quot;                        
## [47] &quot;MS.MS.Scan.Number&quot;                  
## [48] &quot;Score&quot;                              
## [49] &quot;Delta.score&quot;                        
## [50] &quot;Combinatorics&quot;                      
## [51] &quot;Intensity&quot;                          
## [52] &quot;Reverse&quot;                            
## [53] &quot;Potential.contaminant&quot;              
## [54] &quot;id&quot;                                 
## [55] &quot;Protein.group.IDs&quot;                  
## [56] &quot;Peptide.ID&quot;                         
## [57] &quot;Mod..peptide.ID&quot;                    
## [58] &quot;MS.MS.IDs&quot;                          
## [59] &quot;Best.MS.MS&quot;                         
## [60] &quot;AIF.MS.MS.IDs&quot;                      
## [61] &quot;Oxidation..M..site.IDs&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(evi<span class="op">$</span>Raw.file)</code></pre>
<pre><code>##  [1] JD_06232014_sample1-A JD_06232014_sample2_A JD_06232014_sample4_B
##  [4] JD_06232014_sample1_B JD_06232014_sample1_C JD_06232014_sample2_B
##  [7] JD_06232014_sample2_C JD_06232014_sample3_A JD_06232014_sample3_B
## [10] JD_06232014_sample3_C JD_06232014_sample4-A JD_06232014_sample4_C
## 12 Levels: JD_06232014_sample1_B ... JD_06232014_sample4-A</code></pre>
<p>One file is for annotation information, required to fill in Condition and BioReplicate for corresponding Run information. Users have to prepare as csv or txt file like ‘ABRF2015_MaxQuant_annotation.csv’, which includes <strong>Run</strong>, <strong>Condition</strong>, and <strong>BioReplicate</strong> information, and load it in R.</p>
</div>
<div id="set-annotation-file-1" class="section level4">
<h4><span class="header-section-number">1.6.2.2</span> Set annotation file</h4>
<p>Annotation information is required to fill in <strong>Condition</strong> and <strong>BioReplicate</strong> for corresponding <strong>Raw.file</strong> information. Users have to prepare as csv or txt file like ‘ABRF2015_MaxQuant_annotation.csv’, which includes <strong>Raw.file</strong>, <strong>Condition</strong>, and <strong>BioReplicate</strong> information, and load it in R. <strong>Raw.file</strong> column in the annotation file should be the same as unique <strong>Raw.file</strong> in evidence.txt file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in annotation including condition and biological replicates: annotation.csv</span>
annot.maxquant &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/data_MaxQuant/ABRF2015_MaxQuant_annotation.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
annot.maxquant</code></pre>
<pre><code>##                 Raw.file  Condition BioReplicate IsotopeLabelType
## 1  JD_06232014_sample1-A Condition1            1                L
## 2  JD_06232014_sample2_A Condition2            2                L
## 3  JD_06232014_sample4_B Condition4            4                L
## 4  JD_06232014_sample1_B Condition1            1                L
## 5  JD_06232014_sample1_C Condition1            1                L
## 6  JD_06232014_sample2_B Condition2            2                L
## 7  JD_06232014_sample2_C Condition2            2                L
## 8  JD_06232014_sample3_A Condition3            3                L
## 9  JD_06232014_sample3_B Condition3            3                L
## 10 JD_06232014_sample3_C Condition3            3                L
## 11 JD_06232014_sample4-A Condition4            4                L
## 12 JD_06232014_sample4_C Condition4            4                L</code></pre>
</div>
<div id="preprocessing-with-maxqtomsstatsformat" class="section level4">
<h4><span class="header-section-number">1.6.2.3</span> Preprocessing with <code>MaxQtoMSstatsFormat</code></h4>
<p><code>MaxQtoMSstatsFormat</code> function helps pre-processing for making right format of MSstats input from MaxQuant output. Basically, this function gets peptide ion intensity from <code>‘evidence.txt’</code> file. In addition, there are several steps to filter out or to modify the data in order to get required information.</p>
<p>Here is the summary of pre-processing steps in <code>MaxQtoMSstatsFormat</code> function (in orange box below).</p>
<p><img src="img/MSstats_MaxQ.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">?MaxQtoMSstatsFormat</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># reformating and pre-processing for MaxQuant output.</span>
<span class="co"># no protein with 1 peptide</span>
input.maxquant &lt;-<span class="st"> </span><span class="kw">MaxQtoMSstatsFormat</span>(<span class="dt">evidence=</span>evi, 
                                      <span class="dt">annotation=</span>annot.maxquant,
                                      <span class="dt">proteinGroups=</span>proteinGroups,
                                      <span class="dt">removeProtein_with1Peptide=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## ** + Contaminant, + Reverse, + Only.identified.by.site, proteins are removed.</code></pre>
<pre><code>## ** Peptide and charge, that have 1 or 2 measurements across runs, are removed.</code></pre>
<pre><code>## ** 282 proteins, which have only peptide and charge in a protein, are removed among 3157 proteins.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(input.maxquant)</code></pre>
<pre><code>##   ProteinName        PeptideSequence PrecursorCharge FragmentIon
## 1      D6VTK4 EGEVEPVDMYTPDTAADEEARK               3          NA
## 2      D6VTK4    FYPGTLSSFQTDSINNDAK               2          NA
## 3      D6VTK4             IGPFADASYK               2          NA
## 4      D6VTK4          NQFYQLPTPTSSK               2          NA
## 5      D6VTK4           TFVSETADDIEK               2          NA
## 6      D6VTK4         TNTITSDFTTSTDR               2          NA
##   ProductCharge IsotopeLabelType  Condition BioReplicate
## 1            NA                L Condition1            1
## 2            NA                L Condition1            1
## 3            NA                L Condition1            1
## 4            NA                L Condition1            1
## 5            NA                L Condition1            1
## 6            NA                L Condition1            1
##                     Run Intensity
## 1 JD_06232014_sample1_B  87141000
## 2 JD_06232014_sample1_B  46167000
## 3 JD_06232014_sample1_B  45425000
## 4 JD_06232014_sample1_B  47094000
## 5 JD_06232014_sample1_B        NA
## 6 JD_06232014_sample1_B  62786000</code></pre>
</div>
<div id="preliminary-check-1" class="section level4">
<h4><span class="header-section-number">1.6.2.4</span> Preliminary check</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(input.maxquant<span class="op">$</span>ProteinName)) </code></pre>
<pre><code>## [1] 2875</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(input.maxquant<span class="op">$</span>Intensity)) </code></pre>
<pre><code>## [1] 40056</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(input.maxquant<span class="op">$</span>Intensity) <span class="op">&amp;</span><span class="st"> </span>input.maxquant<span class="op">$</span>Intensity<span class="op">==</span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 0</code></pre>
<blockquote>
<p>Challenge</p>
<ul>
<li>Let’s check unique information for <code>Run</code>,<code>BioReplicate</code> and <code>Condition</code> in <code>input.maxquant</code>.</li>
</ul>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(input.maxquant[, <span class="kw">c</span>(<span class="st">&#39;Run&#39;</span>, <span class="st">&#39;BioReplicate&#39;</span>, <span class="st">&#39;Condition&#39;</span>)])</code></pre>
<pre><code>##                          Run BioReplicate  Condition
## 1      JD_06232014_sample1_B            1 Condition1
## 30600  JD_06232014_sample1_C            1 Condition1
## 61199  JD_06232014_sample1-A            1 Condition1
## 91798  JD_06232014_sample2_A            2 Condition2
## 122397 JD_06232014_sample2_B            2 Condition2
## 152996 JD_06232014_sample2_C            2 Condition2
## 183595 JD_06232014_sample3_A            3 Condition3
## 214194 JD_06232014_sample3_B            3 Condition3
## 244793 JD_06232014_sample3_C            3 Condition3
## 275392 JD_06232014_sample4_B            4 Condition4
## 305991 JD_06232014_sample4_C            4 Condition4
## 336590 JD_06232014_sample4-A            4 Condition4</code></pre>
<hr />
</div>
</div>
<div id="openms-output" class="section level3">
<h3><span class="header-section-number">1.6.3</span> OpenMS output</h3>
<div id="read-data-2" class="section level4">
<h4><span class="header-section-number">1.6.3.1</span> Read data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, read output of OpenMS</span>
raw.openMS &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/data_OpenMS/ABRF2015_OpenMS_raw.csv&quot;</span>, <span class="dt">stringsAsFactors=</span>F) <span class="co"># the data file</span>
<span class="kw">head</span>(raw.openMS)</code></pre>
<pre><code>##            ProteinName PeptideSequence PrecursorCharge FragmentIon
## 1 sp|P09938|RIR2_YEAST    AAADALSDLEIK               2          NA
## 2 sp|P09938|RIR2_YEAST    AAADALSDLEIK               2          NA
## 3 sp|P09938|RIR2_YEAST    AAADALSDLEIK               2          NA
## 4 sp|P09938|RIR2_YEAST    AAADALSDLEIK               2          NA
## 5 sp|P09938|RIR2_YEAST    AAADALSDLEIK               2          NA
## 6 sp|P09938|RIR2_YEAST    AAADALSDLEIK               2          NA
##   ProductCharge IsotopeLabelType Condition BioReplicate Run Intensity
## 1             0                L         1            1   1 391797000
## 2             0                L         4            4  10 103656000
## 3             0                L         4            4  11 361107000
## 4             0                L         1            1   2 456756000
## 5             0                L         1            1   3 389268000
## 6             0                L         2            2   4 433488000</code></pre>
</div>
<div id="set-annotation-file-2" class="section level4">
<h4><span class="header-section-number">1.6.3.2</span> Set annotation file</h4>
<p>The output from <code>OpenMS</code> already includes <code>Run</code>, <code>BioReplicate</code>, <code>Condition</code> information. Let’s check it.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(raw.openMS[, <span class="kw">c</span>(<span class="st">&#39;Run&#39;</span>, <span class="st">&#39;BioReplicate&#39;</span>, <span class="st">&#39;Condition&#39;</span>)])</code></pre>
<pre><code>##    Run BioReplicate Condition
## 1    1            1         1
## 2   10            4         4
## 3   11            4         4
## 4    2            1         1
## 5    3            1         1
## 6    4            2         2
## 7    5            2         2
## 8    6            2         2
## 9    7            3         3
## 10   8            3         3
## 11   9            3         3
## 14  12            4         4</code></pre>
</div>
<div id="preprocessing-with-openmstomsstatsformat" class="section level4">
<h4><span class="header-section-number">1.6.3.3</span> Preprocessing with <code>OpenMStoMSstatsFormat</code></h4>
<p>There are several steps to filter out or to modify the data in order to get required information.
Here is the summary of pre-processing steps in <code>OpenMStoMSstatsFormat</code> function.</p>
<p><img src="img/MSstats_OpenMS.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">?OpenMStoMSstatsFormat</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># reformating and pre-processing for OpenMS output.</span>
input.openms &lt;-<span class="st"> </span><span class="kw">OpenMStoMSstatsFormat</span>(raw.openMS,
                                      <span class="dt">removeProtein_with1Feature=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## ** 0 features have all NAs or zero intensity values and are removed.</code></pre>
<pre><code>## ** All peptides are unique peptides in proteins.</code></pre>
<pre><code>## ** 909 features have 1 or 2 intensities across runs and are removed.</code></pre>
<pre><code>## ** 698 proteins, which have only one feature in a protein, are removed among 2538 proteins.</code></pre>
<pre><code>## ** No multiple measurements in a feature and a run.</code></pre>
<pre><code>## Warning in OpenMStoMSstatsFormat(raw.openMS, removeProtein_with1Feature =
## TRUE): NAs introduced by coercion</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## now &#39;input.openms&#39; is ready for MSstats</span>
<span class="kw">head</span>(input.openms)</code></pre>
<pre><code>##            ProteinName        PeptideSequence PrecursorCharge FragmentIon
## 1 sp|D6VTK4|STE2_YEAST EGEVEPVDMYTPDTAADEEARK               3          NA
## 2 sp|D6VTK4|STE2_YEAST    FYPGTLSSFQTDSINNDAK               2          NA
## 3 sp|D6VTK4|STE2_YEAST             IGPFADASYK               2          NA
## 4 sp|D6VTK4|STE2_YEAST          NQFYQLPTPTSSK               2          NA
## 5 sp|D6VTK4|STE2_YEAST           TFVSETADDIEK               2          NA
## 6 sp|D6VTK4|STE2_YEAST         TNTITSDFTTSTDR               2          NA
##   ProductCharge IsotopeLabelType Condition BioReplicate Run Intensity
## 1             0                L         1            1   1  64757900
## 2             0                L         1            1   1  38852700
## 3             0                L         1            1   1  73225800
## 4             0                L         1            1   1  63139900
## 5             0                L         1            1   1        NA
## 6             0                L         1            1   1  58905300</code></pre>
</div>
<div id="preliminary-check-for-preprocessed-data" class="section level4">
<h4><span class="header-section-number">1.6.3.4</span> Preliminary check for preprocessed data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(input.openms<span class="op">$</span>ProteinName)) </code></pre>
<pre><code>## [1] 1840</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(input.openms<span class="op">$</span>Intensity)) </code></pre>
<pre><code>## [1] 21962</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(input.openms<span class="op">$</span>Intensity) <span class="op">&amp;</span><span class="st"> </span>input.openms<span class="op">$</span>Intensity<span class="op">==</span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(input.openms<span class="op">$</span>Run)</code></pre>
<pre><code>## 
##     1     2     3     4     5     6     7     8     9    10    11    12 
## 15560 15560 15560 15560 15560 15560 15560 15560 15560 15560 15560 15560</code></pre>
<blockquote>
<p>Challenge</p>
<ul>
<li>Let’s check unique information for <code>Run</code>,<code>BioReplicate</code> and <code>Condition</code>.</li>
</ul>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(input.openms[, <span class="kw">c</span>(<span class="st">&#39;Run&#39;</span>, <span class="st">&#39;BioReplicate&#39;</span>, <span class="st">&#39;Condition&#39;</span>)]) </code></pre>
<pre><code>##        Run BioReplicate Condition
## 1        1            1         1
## 15561   10            4         4
## 31121   11            4         4
## 46681   12            4         4
## 62241    2            1         1
## 77801    3            1         1
## 93361    4            2         2
## 108921   5            2         2
## 124481   6            2         2
## 140041   7            3         3
## 155601   8            3         3
## 171161   9            3         3</code></pre>
<hr />
</div>
</div>
<div id="progenesis-output" class="section level3">
<h3><span class="header-section-number">1.6.4</span> Progenesis output</h3>
<div id="read-data-3" class="section level4">
<h4><span class="header-section-number">1.6.4.1</span> Read data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, read output of Progenesis</span>
raw.progenesis &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/data_Progenesis/ABRF2015_Progenesis_raw.csv&quot;</span>, <span class="dt">stringsAsFactors=</span>F) <span class="co"># the data file</span>
<span class="kw">head</span>(raw.progenesis)</code></pre>
<pre><code>##       X                  X.1    X.2              X.3              X.4
## 1                                                                    
## 2     # Retention time (min) Charge              m/z    Measured mass
## 3    16     52.5563333333333      2 501.781277638303 1001.54800234285
## 4    32             38.15255      2 474.251481407549 946.488409881339
## 5 11167     36.2224333333333      2  474.25154745893 946.488541984099
## 6    41              45.5598      2 371.731536419815 741.448519905869
##                    X.5               X.6    X.7       X.8           X.9
## 1                                                                      
## 2       Mass error (u)  Mass error (ppm)  Score  Sequence Modifications
## 3 -0.00255665715405939 -2.55269904358308      1 TANDVLTIR              
## 4 -0.00219111866147159 -2.31499251990099      1 VTDGVMVAR              
## 5  -0.0020590159006133 -2.17542139186367      1 VTDGVMVAR              
## 6 -0.00120309413080122 -1.62262402086192 0.9996   AGLNIVR              
##                    X.10
## 1                      
## 2             Accession
## 3 sp|P00549|KPYK1_YEAST
## 4 sp|P00549|KPYK1_YEAST
## 5 sp|P00549|KPYK1_YEAST
## 6 sp|P00549|KPYK1_YEAST
##                                                                                             X.11
## 1                                                                                               
## 2                                                                                    Description
## 3 Pyruvate kinase 1 OS=Saccharomyces cerevisiae (strain ATCC 204508 \\ S288c) GN=CDC19 PE=1 SV=2
## 4 Pyruvate kinase 1 OS=Saccharomyces cerevisiae (strain ATCC 204508 \\ S288c) GN=CDC19 PE=1 SV=2
## 5 Pyruvate kinase 1 OS=Saccharomyces cerevisiae (strain ATCC 204508 \\ S288c) GN=CDC19 PE=1 SV=2
## 6 Pyruvate kinase 1 OS=Saccharomyces cerevisiae (strain ATCC 204508 \\ S288c) GN=CDC19 PE=1 SV=2
##                  X.12             X.13                   X.14
## 1                                                            
## 2 Use in quantitation  Max fold change Highest mean condition
## 3               False 1.23101575731737                      A
## 4               False 1.35108253622201                      B
## 5               False 1.25419527606242                      B
## 6               False 1.04868912680216                      A
##                    X.15               X.16             X.17
## 1                                                          
## 2 Lowest mean condition              Anova       Maximum CV
## 3                     C 0.0522715538027003 12.0175133289667
## 4                     A 0.0393818452091522 26.8776079679151
## 5                     A  0.253277920596793 27.2310093101224
## 6                     B  0.993981434364646 27.0631636013386
##    Normalized.abundance                  X.18                  X.19
## 1                     A                                            
## 2 JD_06232014_sample1-A JD_06232014_sample2_A JD_06232014_sample3_A
## 3      234646642.659118      246323351.490501       306102714.66799
## 4      179120293.733639      104309665.701784      136741892.392964
## 5      2233197.90782367       1134566.5998162      1574437.81004362
## 6      123797188.716029       122761256.64621      116107425.243685
##                    X.20                  X.21                  X.22
## 1                                           B                      
## 2 JD_06232014_sample4-A JD_06232014_sample1_B JD_06232014_sample2_B
## 3      257629531.217182      235779468.539422      236753257.546934
## 4      105011188.469111      182469696.644175      183285243.781685
## 5      1701362.72342001      2336796.51015815      1788630.29256942
## 6       63610598.879437      108255803.660911      108785457.069653
##                    X.23                  X.24                  X.25
## 1                                                                 C
## 2 JD_06232014_sample3_B JD_06232014_sample4_B JD_06232014_sample1_C
## 3      186699807.218591      242959514.796972      223435557.783206
## 4      162853464.030243      180957229.609825      186073547.948691
## 5      1932732.32106691      2274168.76697097       2182403.4051037
## 6      92469286.5619254      96974519.2450418      115737794.475905
##                    X.26                  X.27                  X.28
## 1                                                                  
## 2 JD_06232014_sample2_C JD_06232014_sample3_C JD_06232014_sample4_C
## 3      220456628.684641      197285091.954229      207473304.500931
## 4      163946644.909844      150247529.397207      176820166.306319
## 5       2040841.8048229      1497501.50492545      2156318.09540588
## 6      100428622.768589      109442962.863466      83998024.0208531
##           Raw.abundance                  X.29                  X.30
## 1                     A                                            
## 2 JD_06232014_sample1-A JD_06232014_sample2_A JD_06232014_sample3_A
## 3      244531299.931508      221199440.186087      277078923.760572
## 4      186665863.932395      93670533.1411598      123776414.130536
## 5      2327272.96336292      1018845.73758267       1425154.0840074
## 6      129012233.635811      110240142.001841      105098448.610706
##                    X.31                  X.32                  X.33
## 1                                           B                      
## 2 JD_06232014_sample4-A JD_06232014_sample1_B JD_06232014_sample2_B
## 3      213112377.670857       265826760.55748      265610928.042007
## 4      86865756.2312952      205723291.596601       205625739.64841
## 5      1407375.36397932      2634593.46237989      2006645.04833363
## 6      52618990.9526949      122051719.672593       122045231.85501
##                    X.34                  X.35                  X.36
## 1                                                                 C
## 2 JD_06232014_sample3_B JD_06232014_sample4_B JD_06232014_sample1_C
## 3      219812880.452275      242959514.796972      210648874.118526
## 4      191737150.420336      180957229.609825      175425002.929311
## 5      2275521.67817463      2274168.76697097      2057509.66730008
## 6      108869636.960823      96974519.2450418      109114396.746851
##                    X.37                  X.38                  X.39
## 1                                                                  
## 2 JD_06232014_sample2_C JD_06232014_sample3_C JD_06232014_sample4_C
## 3      207260386.701525      217212520.118758      194785326.277837
## 4      154133015.755399      165423774.187439      166006773.109084
## 5      1918679.71576989       1648761.5589421      2024448.99975338
## 6      94417098.3431607      120497608.498225      78861145.7987456
##         Spectral.counts                  X.40                  X.41
## 1                     A                                            
## 2 JD_06232014_sample1-A JD_06232014_sample2_A JD_06232014_sample3_A
## 3                     2                     1                     1
## 4                     1                     1                     1
## 5                     1                     0                     1
## 6                     2                     2                     2
##                    X.42                  X.43                  X.44
## 1                                           B                      
## 2 JD_06232014_sample4-A JD_06232014_sample1_B JD_06232014_sample2_B
## 3                     3                     2                     3
## 4                     1                     1                     1
## 5                     1                     0                     0
## 6                     2                     2                     2
##                    X.45                  X.46                  X.47
## 1                                                                 C
## 2 JD_06232014_sample3_B JD_06232014_sample4_B JD_06232014_sample1_C
## 3                     2                     2                     2
## 4                     1                     1                     1
## 5                     0                     1                     1
## 6                     2                     2                     2
##                    X.48                  X.49                  X.50
## 1                                                                  
## 2 JD_06232014_sample2_C JD_06232014_sample3_C JD_06232014_sample4_C
## 3                     3                     1                     2
## 4                     1                     1                     1
## 5                     0                     1                     0
## 6                     2                     2                     2</code></pre>
<p>One file is for annotation information, required to fill in Condition and BioReplicate for corresponding Run information. Users have to prepare as csv or txt file like ‘ABRF2015_Progenesis_annotation.csv’, which includes <strong>Run</strong>, <strong>Condition</strong>, and <strong>BioReplicate</strong> information, and load it in R.</p>
</div>
<div id="set-annotation-file-3" class="section level4">
<h4><span class="header-section-number">1.6.4.2</span> Set annotation file</h4>
<p>Annotation information is required to fill in <strong>Condition</strong> and <strong>BioReplicate</strong> for corresponding <strong>Run</strong> information. Users have to prepare as csv or txt file like ‘ABRF2015_Progenesis_annotation.csv’, which includes <strong>Run</strong>, <strong>Condition</strong>, and <strong>BioReplicate</strong> information, and load it in R.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Read in annotation including condition and biological replicates: ABRF2015_Progenesis_annotation.csv</span>
annot.progenesis &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/data_Progenesis/ABRF2015_Progenesis_annotation.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
annot.progenesis</code></pre>
<pre><code>##                      Run  Condition BioReplicate
## 1  JD_06232014_sample1-A Condition1            1
## 2  JD_06232014_sample2_A Condition2            2
## 3  JD_06232014_sample4_B Condition4            4
## 4  JD_06232014_sample1_B Condition1            1
## 5  JD_06232014_sample1_C Condition1            1
## 6  JD_06232014_sample2_B Condition2            2
## 7  JD_06232014_sample2_C Condition2            2
## 8  JD_06232014_sample3_A Condition3            3
## 9  JD_06232014_sample3_B Condition3            3
## 10 JD_06232014_sample3_C Condition3            3
## 11 JD_06232014_sample4-A Condition4            4
## 12 JD_06232014_sample4_C Condition4            4</code></pre>
<p>!! <code>Run</code> information should be the same as annotated in output of <code>Progenesis</code>.</p>
</div>
<div id="preprocessing-with-progenesistomsstatsformat" class="section level4">
<h4><span class="header-section-number">1.6.4.3</span> Preprocessing with <code>ProgenesistoMSstatsFormat</code></h4>
<p>The output from <code>Progenesis</code> includes peptide ion-level quantification for each MS runs. <code>ProgenesistoMSstatsFormat</code> function helps pre-processing for making right format of <code>MSstats</code> input from <code>Progenesis</code> output. Basically, this function reformats wide format to long format. It provide <strong>Raw.abundance</strong>, <strong>Normalized.abundance</strong> and <strong>Spectral count</strong> columns. This converter uses <strong>Raw.abundance</strong> columns for Intensity values. In addition, there are several steps to filter out or to modify the data in order to get required information.
Here is the summary of pre-processing steps in <code>ProgenesistoMSstatsFormat</code> function (in orange box below).</p>
<p><img src="img/MSstats_progenesis.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">?ProgenesistoMSstatsFormat</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># reformating and pre-processing for Progenesis output.</span>
input.progenesis &lt;-<span class="st"> </span><span class="kw">ProgenesistoMSstatsFormat</span>(raw.progenesis, 
                                              <span class="dt">annotation=</span>annot.progenesis,
                                              <span class="dt">removeProtein_with1Peptide=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## ** Peptides, that are used in more than one proteins, are removed.</code></pre>
<pre><code>## ** Multiple measurements in a feature and a run are summarized by summaryforMultipleRows.</code></pre>
<pre><code>## ** 898 proteins, which have only one feature in a protein, are removed among 3913 proteins.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## now &#39;input.progenesis&#39; is ready for MSstats</span>
<span class="kw">head</span>(input.progenesis)</code></pre>
<pre><code>##             ProteinName       PeptideModifiedSequence PrecursorCharge
## 1 sp|A5Z2X5|YP010_YEAST              LTGNPELSSLDEVLAK               2
## 2 sp|A5Z2X5|YP010_YEAST RPAQLLL[N-term] nTerm+42.0106               2
## 3  sp|D6VTK4|STE2_YEAST        EGEVEPVDMYTPDTAADEEARK               3
## 4  sp|D6VTK4|STE2_YEAST           FYPGTLSSFQTDSINNDAK               2
## 5  sp|D6VTK4|STE2_YEAST                    IGPFADASYK               2
## 6  sp|O13297|CET1_YEAST                   IAGNAVGSVVK               2
##   FragmentIon ProductCharge IsotopeLabelType  Condition BioReplicate
## 1          NA            NA                L Condition1            1
## 2          NA            NA                L Condition1            1
## 3          NA            NA                L Condition1            1
## 4          NA            NA                L Condition1            1
## 5          NA            NA                L Condition1            1
## 6          NA            NA                L Condition1            1
##                     Run Intensity
## 1 JD_06232014_sample1_B 2550357.3
## 2 JD_06232014_sample1_B  865491.8
## 3 JD_06232014_sample1_B 3767734.3
## 4 JD_06232014_sample1_B 2591735.2
## 5 JD_06232014_sample1_B 2301483.1
## 6 JD_06232014_sample1_B  415181.8</code></pre>
</div>
<div id="preliminary-check-for-preprocessed-data-1" class="section level4">
<h4><span class="header-section-number">1.6.4.4</span> Preliminary check for preprocessed data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(input.progenesis<span class="op">$</span>ProteinName)) </code></pre>
<pre><code>## [1] 3015</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(input.progenesis<span class="op">$</span>Intensity)) </code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(input.progenesis<span class="op">$</span>Intensity) <span class="op">&amp;</span><span class="st"> </span>input.progenesis<span class="op">$</span>Intensity<span class="op">==</span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 418</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(input.progenesis<span class="op">$</span>Run)</code></pre>
<pre><code>## 
## JD_06232014_sample1-A JD_06232014_sample2_A JD_06232014_sample3_A 
##                  9646                  9646                  9646 
## JD_06232014_sample4-A JD_06232014_sample1_B JD_06232014_sample2_B 
##                  9646                  9646                  9646 
## JD_06232014_sample3_B JD_06232014_sample4_B JD_06232014_sample1_C 
##                  9646                  9646                  9646 
## JD_06232014_sample2_C JD_06232014_sample3_C JD_06232014_sample4_C 
##                  9646                  9646                  9646</code></pre>
<blockquote>
<p>Challenge</p>
<ul>
<li>Let’s check unique information for <code>Run</code>,<code>BioReplicate</code> and <code>Condition</code>.</li>
</ul>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(input.progenesis[, <span class="kw">c</span>(<span class="st">&#39;Run&#39;</span>, <span class="st">&#39;BioReplicate&#39;</span>, <span class="st">&#39;Condition&#39;</span>)]) </code></pre>
<pre><code>##                          Run BioReplicate  Condition
## 1      JD_06232014_sample1_B            1 Condition1
## 10547  JD_06232014_sample1_C            1 Condition1
## 21093  JD_06232014_sample1-A            1 Condition1
## 31639  JD_06232014_sample2_A            2 Condition2
## 42185  JD_06232014_sample2_B            2 Condition2
## 52731  JD_06232014_sample2_C            2 Condition2
## 63277  JD_06232014_sample3_A            3 Condition3
## 73823  JD_06232014_sample3_B            3 Condition3
## 84369  JD_06232014_sample3_C            3 Condition3
## 94915  JD_06232014_sample4_B            4 Condition4
## 105461 JD_06232014_sample4_C            4 Condition4
## 116007 JD_06232014_sample4-A            4 Condition4</code></pre>
<hr />
</div>
</div>
</div>
<div id="save-your-work" class="section level2">
<h2><span class="header-section-number">1.7</span> Save your work</h2>
<p>We can save the data that we made so far.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(input.skyline, <span class="dt">file=</span><span class="st">&#39;data/data_Skyline/input.skyline.rda&#39;</span>)
<span class="kw">save</span>(input.maxquant, <span class="dt">file=</span><span class="st">&#39;data/data_MaxQuant/input.maxquant.rda&#39;</span>)
<span class="kw">save</span>(input.openms, <span class="dt">file=</span><span class="st">&#39;data/data_OpenMS/input.openms.rda&#39;</span>)
<span class="kw">save</span>(input.progenesis, <span class="dt">file=</span><span class="st">&#39;data/data_Progenesis/input.progenesis.rda&#39;</span>)</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/MayInst_P6_day1_sec1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
