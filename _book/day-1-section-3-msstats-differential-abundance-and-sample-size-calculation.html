<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 3 Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation | May Institute 2019: Statistics for quantitative mass spsectrometry</title>
  <meta name="description" content="Chapter 3 Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation | May Institute 2019: Statistics for quantitative mass spsectrometry">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 3 Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation | May Institute 2019: Statistics for quantitative mass spsectrometry" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation | May Institute 2019: Statistics for quantitative mass spsectrometry" />
  
  
  

<meta name="author" content="Meena Choi and Ting Huang">


<meta name="date" content="2019-05-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Before we start</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#suggested-reading"><i class="fa fa-check"></i>Suggested reading</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><i class="fa fa-check"></i><b>1</b> Day 1 - Section 1 : MSstats, introduction to data and preprocessing</a><ul>
<li class="chapter" data-level="1.1" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#objective"><i class="fa fa-check"></i><b>1.1</b> Objective</a></li>
<li class="chapter" data-level="1.2" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#workflow-in-msstats"><i class="fa fa-check"></i><b>1.2</b> Workflow in MSstats</a></li>
<li class="chapter" data-level="1.3" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#data"><i class="fa fa-check"></i><b>1.3</b> Data</a></li>
<li class="chapter" data-level="1.4" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#load-msstats"><i class="fa fa-check"></i><b>1.4</b> Load MSstats</a></li>
<li class="chapter" data-level="1.5" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#allowable-data-formats"><i class="fa fa-check"></i><b>1.5</b> Allowable data formats</a></li>
<li class="chapter" data-level="1.6" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#convert-to-msstats-required-format-data-cleaning"><i class="fa fa-check"></i><b>1.6</b> Convert to MSstats required format (Data cleaning)</a><ul>
<li class="chapter" data-level="1.6.1" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#skyline-output"><i class="fa fa-check"></i><b>1.6.1</b> Skyline output</a></li>
<li class="chapter" data-level="1.6.2" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#maxquant-output"><i class="fa fa-check"></i><b>1.6.2</b> MaxQuant output</a></li>
<li class="chapter" data-level="1.6.3" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#openms-output"><i class="fa fa-check"></i><b>1.6.3</b> OpenMS output</a></li>
<li class="chapter" data-level="1.6.4" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#progenesis-output"><i class="fa fa-check"></i><b>1.6.4</b> Progenesis output</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html"><a href="day-1-section-1-msstats-introduction-to-data-and-preprocessing.html#save-your-work"><i class="fa fa-check"></i><b>1.7</b> Save your work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><i class="fa fa-check"></i><b>2</b> Day 1 - Section 2 : MSstats, Data processing - Normalization and run summarization</a><ul>
<li class="chapter" data-level="2.1" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#data-1"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-skyline-data"><i class="fa fa-check"></i><b>2.2</b> dataProcess with Skyline data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#load-msstats-1"><i class="fa fa-check"></i><b>2.2.1</b> Load MSstats</a></li>
<li class="chapter" data-level="2.2.2" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#load-the-pre-processed-data-of-skyline-output"><i class="fa fa-check"></i><b>2.2.2</b> Load the pre-processed data of Skyline output</a></li>
<li class="chapter" data-level="2.2.3" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#normalizing-and-summarizing-data-with-dataprocess"><i class="fa fa-check"></i><b>2.2.3</b> Normalizing and summarizing data with dataProcess</a></li>
<li class="chapter" data-level="2.2.4" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#visualization-of-processed-data"><i class="fa fa-check"></i><b>2.2.4</b> Visualization of processed data</a></li>
<li class="chapter" data-level="2.2.5" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#different-normalization-option"><i class="fa fa-check"></i><b>2.2.5</b> Different normalization option</a></li>
<li class="chapter" data-level="2.2.6" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#different-summarization-option"><i class="fa fa-check"></i><b>2.2.6</b> Different summarization option</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-maxquant-data"><i class="fa fa-check"></i><b>2.3</b> dataProcess with MaxQuant data</a></li>
<li class="chapter" data-level="2.4" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-openms-data"><i class="fa fa-check"></i><b>2.4</b> dataProcess with OpenMS data</a></li>
<li class="chapter" data-level="2.5" data-path="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html"><a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html#dataprocess-with-progenesis-data"><i class="fa fa-check"></i><b>2.5</b> dataProcess with Progenesis data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><i class="fa fa-check"></i><b>3</b> Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation</a><ul>
<li class="chapter" data-level="3.1" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#summary"><i class="fa fa-check"></i><b>3.1</b> Summary</a></li>
<li class="chapter" data-level="3.2" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#data-2"><i class="fa fa-check"></i><b>3.2</b> Data</a></li>
<li class="chapter" data-level="3.3" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#load-msstats-2"><i class="fa fa-check"></i><b>3.3</b> Load MSstats</a></li>
<li class="chapter" data-level="3.4" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#inference-and-future-design-of-experiment-with-skyline-output"><i class="fa fa-check"></i><b>3.4</b> Inference and future design of experiment with Skyline output</a><ul>
<li class="chapter" data-level="3.4.1" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#load-the-processed-data-output-of-dataprocess-of-skyline-output"><i class="fa fa-check"></i><b>3.4.1</b> Load the processed data (output of <code>dataProcess</code>) of Skyline output</a></li>
<li class="chapter" data-level="3.4.2" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#finding-differentially-abundant-proteins-across-conditions"><i class="fa fa-check"></i><b>3.4.2</b> Finding differentially abundant proteins across conditions</a></li>
<li class="chapter" data-level="3.4.3" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#visualization-of-differentially-abundant-proteins"><i class="fa fa-check"></i><b>3.4.3</b> Visualization of differentially abundant proteins</a></li>
<li class="chapter" data-level="3.4.4" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#planning-future-experimental-designs"><i class="fa fa-check"></i><b>3.4.4</b> Planning future experimental designs</a></li>
<li class="chapter" data-level="3.4.5" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#protein-subject-quantification"><i class="fa fa-check"></i><b>3.4.5</b> Protein subject quantification</a></li>
<li class="chapter" data-level="3.4.6" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#msstats.log-and-sessioninfo.txt"><i class="fa fa-check"></i><b>3.4.6</b> msstats.log and sessionInfo.txt</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#inference-and-future-design-of-experiment-with-skyline-output-1"><i class="fa fa-check"></i><b>3.5</b> Inference and future design of experiment with Skyline output</a></li>
<li class="chapter" data-level="3.6" data-path="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html"><a href="day-1-section-3-msstats-differential-abundance-and-sample-size-calculation.html#inference-and-future-design-of-experiment-with-openms-output"><i class="fa fa-check"></i><b>3.6</b> Inference and future design of experiment with OpenMS output</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">May Institute 2019: Statistics for quantitative mass spsectrometry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-1---section-3-msstats-differential-abundance-and-sample-size-calculation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Day 1 - Section 3 : MSstats, Differential abundance and sample size calculation</h1>
<div id="summary" class="section level2">
<h2><span class="header-section-number">3.1</span> Summary</h2>
<ul>
<li>Significance analysis for MS proteomics based peak intenesities data</li>
</ul>
</div>
<div id="data-2" class="section level2">
<h2><span class="header-section-number">3.2</span> Data</h2>
<ul>
<li>The processed data, <code>quant.skyline.rda</code>, <code>quant.maxquant.rda</code>, <code>quant.openms.rda</code>, <code>quant.progenesis.rda</code>, which is output of <code>dataProcess</code> from section 2.</li>
</ul>
<hr />
</div>
<div id="load-msstats-2" class="section level2">
<h2><span class="header-section-number">3.3</span> Load MSstats</h2>
<p>Load MSstats first. Then you are ready to start MSstats.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MSstats)
?MSstats</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;ggplot2&#39;:
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang</code></pre>
</div>
<div id="inference-and-future-design-of-experiment-with-skyline-output" class="section level2">
<h2><span class="header-section-number">3.4</span> Inference and future design of experiment with Skyline output</h2>
<div id="load-the-processed-data-output-of-dataprocess-of-skyline-output" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Load the processed data (output of <code>dataProcess</code>) of Skyline output</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="dt">file=</span><span class="st">&#39;data/data_Skyline/quant.skyline.rda&#39;</span>)</code></pre>
<hr />
</div>
<div id="finding-differentially-abundant-proteins-across-conditions" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Finding differentially abundant proteins across conditions</h3>
<p><img src="img/MSstats_groupComparison.png" style="width:90.0%" /></p>
<div id="assign-contrast-matrix" class="section level4">
<h4><span class="header-section-number">3.4.2.1</span> Assign contrast matrix</h4>
<p>After we normalized the data and summarized each protein’s behaviour across conditions in <code>dataProcess</code> step, we are all set to compare protein changes between groups of conditions. Within MSstats we can do this with the <code>groupComparison</code> function, which takes as input the output of the <code>dataProcess</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">?groupComparison</code></pre>
<p>We have to tell <code>groupComparison</code> which are the conditions we would like to compare.
You can make your <code>contrast.matrix</code> in R in a text editor. We define our contrast matrix by adding a column for every condition, <strong>in alphabetical order</strong>. We add a row for every comparison we would like to make between groups of conditions.</p>
<p><strong>0</strong> is for conditions we would like to ignore.
<strong>1</strong> is for conditions we would like to put in the numerator of the ratio or fold-change.
<strong>-1</strong> is for conditions we would like to put in the denumerator of the ratio or fold-change.</p>
<p>If you have multiple groups, you can assign any gruop comparisons you are interested in. For example, if you have 4 different conditions, Condition1, Condition2, Condition3, Condition4, there are many possible comparisons.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check unique conditions and check order of condition information</span>
<span class="co"># In this case, Disease and Healthy</span>
<span class="kw">unique</span>(quant.skyline<span class="op">$</span>ProcessedData<span class="op">$</span>GROUP_ORIGINAL)</code></pre>
<pre><code>## [1] Condition1 Condition2 Condition3 Condition4
## Levels: Condition1 Condition2 Condition3 Condition4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">comparison1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison2&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison&lt;-<span class="kw">rbind</span>(comparison1, comparison2)
<span class="kw">row.names</span>(comparison)&lt;-<span class="kw">c</span>(<span class="st">&quot;C2-C1&quot;</span>,<span class="st">&quot;C3-C1&quot;</span>)

comparison</code></pre>
<pre><code>##       [,1] [,2] [,3] [,4]
## C2-C1   -1    1    0    0
## C3-C1   -1    0    1    0</code></pre>
<blockquote>
<p>Challenges</p>
<p>Make the matrix, named <code>comparison</code>, for all 6 paired comparision among 4 conditions (condition1, condition2, condition3, condition4)</p>
</blockquote>
<details>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(quant.skyline<span class="op">$</span>ProcessedData<span class="op">$</span>GROUP_ORIGINAL)</code></pre>
<pre><code>## [1] Condition1 Condition2 Condition3 Condition4
## Levels: Condition1 Condition2 Condition3 Condition4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">comparison1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison2&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison3&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison4&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison5&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison6&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
comparison&lt;-<span class="kw">rbind</span>(comparison1, comparison2, comparison3, comparison4, comparison5, comparison6)
<span class="kw">row.names</span>(comparison)&lt;-<span class="kw">c</span>(<span class="st">&quot;C2-C1&quot;</span>,<span class="st">&quot;C3-C1&quot;</span>,<span class="st">&quot;C4-C1&quot;</span>,<span class="st">&quot;C3-C2&quot;</span>,<span class="st">&quot;C4-C2&quot;</span>,<span class="st">&quot;C4-C3&quot;</span>)

comparison</code></pre>
<pre><code>##       [,1] [,2] [,3] [,4]
## C2-C1   -1    1    0    0
## C3-C1   -1    0    1    0
## C4-C1   -1    0    0    1
## C3-C2    0   -1    1    0
## C4-C2    0   -1    0    1
## C4-C3    0    0   -1    1</code></pre>
</details>
</div>
<div id="comparing-conditions-with-groupcomparison" class="section level4">
<h4><span class="header-section-number">3.4.2.2</span> Comparing conditions with <code>groupComparison</code></h4>
<p><code>groupComparison</code> uses the run-level summarized data (<code>$RunlevelData</code> from <code>dataProcess</code> function) for hypothesis testing.</p>
<pre class="sourceCode r"><code class="sourceCode r">test.skyline &lt;-<span class="st"> </span><span class="kw">groupComparison</span>(<span class="dt">contrast.matrix=</span>comparison, <span class="dt">data=</span>quant.skyline)</code></pre>
<p>Let’s check the output.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(test.skyline)</code></pre>
<pre><code>## [1] &quot;list&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(test.skyline)</code></pre>
<pre><code>## [1] &quot;ComparisonResult&quot; &quot;ModelQC&quot;          &quot;fittedmodel&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show test result</span>
<span class="co"># Label : which comparison is used</span>
<span class="co"># log2FC : estimated log2 fold change between Diseased and Healthy</span>
<span class="co"># adj.pvalue : adjusted p value</span>
<span class="co"># issue : detect whether this protein has any issue for comparison</span>
<span class="co">#    such as, there is measurement in certain group, or no measurement at all.</span>
<span class="co"># MissingPercentage : the number of missing intensities/total number of intensities </span>
<span class="co">#     in conditions your are interested in for comparison</span>
<span class="co"># ImputationPercentage : the number of imputed intensities/total number of intensities </span>
<span class="co">#     in conditions your are interested in for comparison</span>
<span class="kw">head</span>(test.skyline<span class="op">$</span>ComparisonResult)</code></pre>
<pre><code>##                 Protein Label      log2FC         SE     Tvalue DF
## 1  sp|D6VTK4|STE2_YEAST C2-C1  0.06094263 0.10304517  0.5914167  8
## 2  sp|O13297|CET1_YEAST C2-C1 -0.11024579 0.07589698 -1.4525714  8
## 3  sp|O13329|FOB1_YEAST C2-C1 -0.16114268 0.29273717 -0.5504688  8
## 4  sp|O13539|THP2_YEAST C2-C1 -0.43646953 0.83013182 -0.5257834  8
## 5 sp|O13547|CCW14_YEAST C2-C1 -0.05679619 0.14506388 -0.3915254  8
## 6 sp|O13563|RPN13_YEAST C2-C1 -0.16850033 0.09496183 -1.7744006  8
##      pvalue adj.pvalue issue MissingPercentage ImputationPercentage
## 1 0.5705706  0.9983122    NA                 0                    0
## 2 0.1844096  0.9983122    NA                 0                    0
## 3 0.5970289  0.9983122    NA                 0                    0
## 4 0.6132973  0.9983122    NA                 0                    0
## 5 0.7056311  0.9983122    NA                 0                    0
## 6 0.1139193  0.9983122    NA                 0                    0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># After fitting linear model, residuals and fitted values can be shown.</span>
<span class="kw">head</span>(test.skyline<span class="op">$</span>ModelQC)</code></pre>
<pre><code>##    RUN              PROTEIN ABUNDANCE NumMeasuredFeature MissingPercentage
## 1:   1 sp|D6VTK4|STE2_YEAST  26.95958                  7                 0
## 2:   2 sp|D6VTK4|STE2_YEAST  26.78088                  7                 0
## 3:   3 sp|D6VTK4|STE2_YEAST  26.68074                  7                 0
## 4:   4 sp|D6VTK4|STE2_YEAST  26.98540                  7                 0
## 5:   5 sp|D6VTK4|STE2_YEAST  26.90384                  7                 0
## 6:   6 sp|D6VTK4|STE2_YEAST  26.71479                  7                 0
##    more50missing NumImputedFeature               originalRUN GROUP
## 1:         FALSE                 0 JD_06232014_sample1_B.raw     1
## 2:         FALSE                 0 JD_06232014_sample1_C.raw     1
## 3:         FALSE                 0 JD_06232014_sample1-A.raw     1
## 4:         FALSE                 0 JD_06232014_sample2_A.raw     2
## 5:         FALSE                 0 JD_06232014_sample2_B.raw     2
## 6:         FALSE                 0 JD_06232014_sample2_C.raw     2
##    GROUP_ORIGINAL SUBJECT_ORIGINAL SUBJECT_NESTED SUBJECT   residuals
## 1:     Condition1                1            1.1       1  0.15251179
## 2:     Condition1                1            1.1       1 -0.02618545
## 3:     Condition1                1            1.1       1 -0.12632634
## 4:     Condition2                2            2.4       4  0.11739159
## 5:     Condition2                2            2.4       4  0.03582686
## 6:     Condition2                2            2.4       4 -0.15321844
##      fitted
## 1: 26.80707
## 2: 26.80707
## 3: 26.80707
## 4: 26.86801
## 5: 26.86801
## 6: 26.86801</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fitted model per protein</span>
<span class="kw">head</span>(test.skyline<span class="op">$</span>fittedmodel)</code></pre>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##    26.80707      0.06094     -0.16303     -0.11015  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##    24.69673     -0.11025     -0.13596     -0.08799  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##     23.6136      -0.1611       0.1294      -0.3427  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##     26.3935      -0.4365      -0.4232      -0.4941  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##    27.04062     -0.05680     -0.28259     -0.08648  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##    26.17882     -0.16850     -0.06754     -0.20791</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">test.skyline<span class="op">$</span>fittedmodel[[<span class="dv">1</span>]]</code></pre>
<pre><code>## 
## Call:
## lm(formula = ABUNDANCE ~ GROUP, data = data2)
## 
## Coefficients:
## (Intercept)       GROUP2       GROUP3       GROUP4  
##    26.80707      0.06094     -0.16303     -0.11015</code></pre>
</div>
<div id="save-the-comparison-result" class="section level4">
<h4><span class="header-section-number">3.4.2.3</span> Save the comparison result</h4>
<p>Let’s save the testing result as rdata and .csv file.</p>
<pre class="sourceCode r"><code class="sourceCode r">Skyline.result &lt;-<span class="st"> </span>test.skyline<span class="op">$</span>ComparisonResult

<span class="kw">save</span>(Skyline.result, <span class="dt">file=</span><span class="st">&#39;data/data_Skyline/Skyline.result.rda&#39;</span>)
<span class="kw">write.csv</span>(Skyline.result, <span class="dt">file=</span><span class="st">&#39;data/data_Skyline/testResult_ABRF_skyline.csv&#39;</span>)</code></pre>
</div>
<div id="subset-of-significant-comparisons" class="section level4">
<h4><span class="header-section-number">3.4.2.4</span> subset of significant comparisons</h4>
<p>Let’s inspect the results to see what proteins are changing significantly between Diseased and Healthy.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(Skyline.result)</code></pre>
<pre><code>##                 Protein Label      log2FC         SE     Tvalue DF
## 1  sp|D6VTK4|STE2_YEAST C2-C1  0.06094263 0.10304517  0.5914167  8
## 2  sp|O13297|CET1_YEAST C2-C1 -0.11024579 0.07589698 -1.4525714  8
## 3  sp|O13329|FOB1_YEAST C2-C1 -0.16114268 0.29273717 -0.5504688  8
## 4  sp|O13539|THP2_YEAST C2-C1 -0.43646953 0.83013182 -0.5257834  8
## 5 sp|O13547|CCW14_YEAST C2-C1 -0.05679619 0.14506388 -0.3915254  8
## 6 sp|O13563|RPN13_YEAST C2-C1 -0.16850033 0.09496183 -1.7744006  8
##      pvalue adj.pvalue issue MissingPercentage ImputationPercentage
## 1 0.5705706  0.9983122    NA                 0                    0
## 2 0.1844096  0.9983122    NA                 0                    0
## 3 0.5970289  0.9983122    NA                 0                    0
## 4 0.6132973  0.9983122    NA                 0                    0
## 5 0.7056311  0.9983122    NA                 0                    0
## 6 0.1139193  0.9983122    NA                 0                    0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select subset of rows with adj.pvalue &lt; 0.05</span>
SignificantProteins &lt;-<span class="st"> </span>
<span class="st">  </span>Skyline.result[Skyline.result<span class="op">$</span>adj.pvalue <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>, ]

<span class="kw">nrow</span>(SignificantProteins)</code></pre>
<pre><code>## [1] 28</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select subset of rows with adj.pvalue &lt; 0.05 and log2FC &gt; 2</span>
SignificantProteinsUpInDiseased &lt;-<span class="st"> </span>SignificantProteins[SignificantProteins<span class="op">$</span>log2FC <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> ,]

<span class="kw">nrow</span>(SignificantProteinsUpInDiseased)</code></pre>
<pre><code>## [1] 14</code></pre>
<hr />
</div>
</div>
<div id="visualization-of-differentially-abundant-proteins" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Visualization of differentially abundant proteins</h3>
<pre class="sourceCode r"><code class="sourceCode r">?groupComparisonPlots</code></pre>
<div id="volcano-plot" class="section level4">
<h4><span class="header-section-number">3.4.3.1</span> Volcano plot</h4>
<p>Volcano plots allow us to visually separate strong changes, which are not significant, from strong and significant changes. Look for these subjects in the upper right and upper left quadrants of the plot. Protein name will be shown only for siginificant proteins.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">groupComparisonPlots</span>(<span class="dt">data =</span> Skyline.result, 
                     <span class="dt">type =</span> <span class="st">&#39;VolcanoPlot&#39;</span>,
                     <span class="dt">address =</span> <span class="st">&#39;data/data_Skyline/testResult_ABRF_skyline_&#39;</span>)</code></pre>
<p><img src="img/ABRF_skyline_VolcanoPlot_1.png" style="width:60.0%" /></p>
<p>We can set up estimated fold change cutoff.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">groupComparisonPlots</span>(<span class="dt">data =</span> Skyline.result, 
                     <span class="dt">type =</span> <span class="st">&#39;VolcanoPlot&#39;</span>,
                     <span class="dt">sig =</span> <span class="fl">0.05</span>, 
                     <span class="dt">FCcutoff =</span> <span class="dv">2</span><span class="op">^</span><span class="dv">2</span>, 
                     <span class="dt">address =</span> <span class="st">&#39;data/data_Skyline/testResult_ABRF_skyline_FCcutoff4_&#39;</span>)</code></pre>
<p><img src="img/ABRF_skyline_FCcutoff4_VolcanoPlot_1.png" style="width:60.0%" /></p>
</div>
<div id="comparison-plot" class="section level4">
<h4><span class="header-section-number">3.4.3.2</span> Comparison plot</h4>
<p>Comparison plots illustrate model-based estimates of log-fold changes, and the associated
uncertainty, in several comparisons of conditions for one protein. X-axis is the comparison of
interest. Y-axis is the log fold change. The dots are the model-based estimates of log-fold
change, and the error bars are the model-based 95% confidence intervals (the option sig can
be used to change the significance level of significance). For simplicity, the confidence intervals
are adjusted for multiple comparisons within protein only, using the Bonferroni approach. For
proteins with N comparisons, the individual confidence intervals are at the level of 1-sig/N.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">groupComparisonPlots</span>(Skyline.result, 
                     <span class="dt">type=</span><span class="st">&quot;ComparisonPlot&quot;</span>, 
                     <span class="dt">address=</span><span class="st">&quot;data/data_Skyline/testResult_ABRF_skyline_&quot;</span>)</code></pre>
<p><img src="img/testResult_ABRF_skyline_ComparisonPlot_P44015.png" style="width:60.0%" /></p>
<p>Let’s check the comparison result for protein <code>sp|P44015|VAC2_YEAST</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">Skyline.result[Skyline.result<span class="op">$</span>Protein <span class="op">==</span><span class="st"> &#39;sp|P44015|VAC2_YEAST&#39;</span>, ]</code></pre>
<pre><code>##                    Protein Label     log2FC        SE      Tvalue DF
## 1756  sp|P44015|VAC2_YEAST C2-C1 -0.2287384 0.3108677  -0.7358063  8
## 4774  sp|P44015|VAC2_YEAST C3-C1 -2.9716852 0.3108677  -9.5593254  8
## 7792  sp|P44015|VAC2_YEAST C4-C1 -5.2574901 0.3108677 -16.9123090  8
## 10810 sp|P44015|VAC2_YEAST C3-C2 -2.7429468 0.3108677  -8.8235190  8
## 13828 sp|P44015|VAC2_YEAST C4-C2 -5.0287517 0.3108677 -16.1765027  8
## 16846 sp|P44015|VAC2_YEAST C4-C3 -2.2858049 0.3108677  -7.3529837  8
##             pvalue   adj.pvalue issue MissingPercentage
## 1756  4.828617e-01 0.9983122047    NA                 0
## 4774  1.187124e-05 0.0089568526    NA                 0
## 7792  1.515151e-07 0.0001143182    NA                 0
## 10810 2.143047e-05 0.0129354325    NA                 0
## 13828 2.143125e-07 0.0001293590    NA                 0
## 16846 7.970992e-05 0.0601411333    NA                 0
##       ImputationPercentage
## 1756                     0
## 4774                     0
## 7792                     0
## 10810                    0
## 13828                    0
## 16846                    0</code></pre>
<hr />
</div>
</div>
<div id="planning-future-experimental-designs" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Planning future experimental designs</h3>
<p><img src="img/MSstats_workflow_design.png" style="width:90.0%" /></p>
<p>This last analysis step views the dataset as a pilot study of a future experiment, utilizes its variance components, and calculates the minimal number of replicates required in a future
experiment to achieve the desired statistical power. The calculation is performed by the function <code>designSampleSize</code>, which takes as input the fitted model in <code>groupComparison</code>. Sample size calculation assumes same experimental design (i.e. group comparison, time course or paired design) as in the current dataset, and uses the model fit to estimate the median variance components across all the proteins. Finally, sample size calculation assumes that a large proportion of proteins (specifically, 99%) will not change in abundance in the future experiment. This assumption also provides conservative results.
Using the estimated variance components, the function relates the number of biological replicates per condition (<code>numSample</code>, rounded to 0 decimal), average statistical power across all the proteins (<code>power</code>), minimal fold change that we would like to detect (can be specified as a range, e.g. <code>desiredFC=c(1.1, 2)</code>), and the False Discovery Rate (<code>FDR</code>). The user should specify all these quantities but one, and the function will solve for the remainder. The quantity to solve for should be set to <code>= TRUE</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">?designSampleSize</code></pre>
<div id="calculating-statistical-power" class="section level4">
<h4><span class="header-section-number">3.4.4.1</span> Calculating statistical power</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate the power</span>
test.power &lt;-<span class="st"> </span><span class="kw">designSampleSize</span>(<span class="dt">data =</span> test.skyline<span class="op">$</span>fittedmodel, 
                               <span class="dt">desiredFC =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.6</span>), 
                               <span class="dt">FDR =</span> <span class="fl">0.05</span>,
                               <span class="dt">power =</span> <span class="ot">TRUE</span>,
                               <span class="dt">numSample =</span> <span class="dv">3</span>)
test.power</code></pre>
<pre><code>##    desiredFC numSample  FDR power    CV
## 1      1.100         3 0.05  0.01 0.010
## 2      1.125         3 0.05  0.01 0.010
## 3      1.150         3 0.05  0.01 0.010
## 4      1.175         3 0.05  0.01 0.010
## 5      1.200         3 0.05  0.04 0.009
## 6      1.225         3 0.05  0.10 0.009
## 7      1.250         3 0.05  0.20 0.009
## 8      1.275         3 0.05  0.33 0.009
## 9      1.300         3 0.05  0.47 0.009
## 10     1.325         3 0.05  0.59 0.008
## 11     1.350         3 0.05  0.70 0.008
## 12     1.375         3 0.05  0.79 0.008
## 13     1.400         3 0.05  0.86 0.008
## 14     1.425         3 0.05  0.91 0.008
## 15     1.450         3 0.05  0.94 0.008
## 16     1.475         3 0.05  0.97 0.008
## 17     1.500         3 0.05  0.98 0.007
## 18     1.525         3 0.05  0.99 0.007
## 19     1.550         3 0.05  0.99 0.007
## 20     1.575         3 0.05  0.99 0.007
## 21     1.600         3 0.05  0.99 0.007</code></pre>
</div>
<div id="visualizing-the-relationship-between-desired-fold-change-and-power" class="section level4">
<h4><span class="header-section-number">3.4.4.2</span> Visualizing the relationship between desired fold-change and power</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">designSampleSizePlots</span>(<span class="dt">data =</span> test.power)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="designing-sample-size-for-desired-fold-change" class="section level4">
<h4><span class="header-section-number">3.4.4.3</span> Designing sample size for desired fold-change</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Minimal number of biological replicates per condition</span>
samplesize &lt;-<span class="st"> </span><span class="kw">designSampleSize</span>(<span class="dt">data =</span> test.skyline<span class="op">$</span>fittedmodel, 
                               <span class="dt">desiredFC =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.6</span>), 
                               <span class="dt">FDR =</span> <span class="fl">0.05</span>,
                               <span class="dt">power =</span> <span class="fl">0.9</span>,
                               <span class="dt">numSample =</span> <span class="ot">TRUE</span>)
samplesize</code></pre>
<pre><code>##    desiredFC numSample  FDR power    CV
## 1      1.100        40 0.05   0.9 0.001
## 2      1.125        26 0.05   0.9 0.001
## 3      1.150        19 0.05   0.9 0.002
## 4      1.175        14 0.05   0.9 0.002
## 5      1.200        11 0.05   0.9 0.003
## 6      1.225         9 0.05   0.9 0.003
## 7      1.250         7 0.05   0.9 0.004
## 8      1.275         6 0.05   0.9 0.004
## 9      1.300         5 0.05   0.9 0.005
## 10     1.325         5 0.05   0.9 0.005
## 11     1.350         4 0.05   0.9 0.006
## 12     1.375         4 0.05   0.9 0.006
## 13     1.400         3 0.05   0.9 0.008
## 14     1.425         3 0.05   0.9 0.008
## 15     1.450         3 0.05   0.9 0.008
## 16     1.475         2 0.05   0.9 0.011
## 17     1.500         2 0.05   0.9 0.011
## 18     1.525         2 0.05   0.9 0.011
## 19     1.550         2 0.05   0.9 0.011
## 20     1.575         2 0.05   0.9 0.011
## 21     1.600         2 0.05   0.9 0.010</code></pre>
</div>
<div id="visualizing-the-relationship-between-desired-fold-change-and-mininum-sample-size-number" class="section level4">
<h4><span class="header-section-number">3.4.4.4</span> Visualizing the relationship between desired fold-change and mininum sample size number</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">designSampleSizePlots</span>(<span class="dt">data =</span> samplesize)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="protein-subject-quantification" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Protein subject quantification</h3>
<p><img src="img/MSstats_workflow_quantification.png" style="width:90.0%" /></p>
<p>If there is no technical replicate, subject (or sample) quantification should be the same as run-level summarization. If there are technical replicates, subjet-level summarization(quantification) with run-level summarization will be useful for downstream analysis, such as classification.</p>
<pre class="sourceCode r"><code class="sourceCode r">?quantification</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sampleQuant &lt;-<span class="st"> </span><span class="kw">quantification</span>(quant.skyline)
<span class="kw">head</span>(sampleQuant)</code></pre>
<pre><code>##                 Protein Condition1_1 Condition2_2 Condition3_3
## 1  sp|D6VTK4|STE2_YEAST     26.78088     26.90384     26.66612
## 2  sp|O13297|CET1_YEAST     24.70436     24.57744     24.62774
## 3  sp|O13329|FOB1_YEAST     23.45702     23.42441     23.73640
## 4  sp|O13539|THP2_YEAST     27.38323     25.90526     25.91699
## 5 sp|O13547|CCW14_YEAST     27.10266     26.90316     26.75663
## 6 sp|O13563|RPN13_YEAST     26.15683     26.00957     26.11312
##   Condition4_4
## 1     26.75137
## 2     24.64624
## 3     23.16385
## 4     25.92043
## 5     26.97820
## 6     26.05676</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">groupQuant &lt;-<span class="st"> </span><span class="kw">quantification</span>(quant.skyline, <span class="dt">type=</span><span class="st">&#39;Group&#39;</span>)
<span class="kw">head</span>(groupQuant)</code></pre>
<pre><code>##                 Protein Condition1 Condition2 Condition3 Condition4
## 1  sp|D6VTK4|STE2_YEAST   26.78088   26.90384   26.66612   26.75137
## 2  sp|O13297|CET1_YEAST   24.70436   24.57744   24.62774   24.64624
## 3  sp|O13329|FOB1_YEAST   23.45702   23.42441   23.73640   23.16385
## 4  sp|O13539|THP2_YEAST   27.38323   25.90526   25.91699   25.92043
## 5 sp|O13547|CCW14_YEAST   27.10266   26.90316   26.75663   26.97820
## 6 sp|O13563|RPN13_YEAST   26.15683   26.00957   26.11312   26.05676</code></pre>
<hr />
</div>
<div id="msstats.log-and-sessioninfo.txt" class="section level3">
<h3><span class="header-section-number">3.4.6</span> msstats.log and sessionInfo.txt</h3>
<p>These two files are important to keep the records of package versions and options in functions.</p>
<p><img src="img/logfileexample.png" style="width:90.0%" /></p>
<hr />
</div>
</div>
<div id="inference-and-future-design-of-experiment-with-skyline-output-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Inference and future design of experiment with Skyline output</h2>
<blockquote>
<p>Challenges</p>
<p>Load the processed data (output of dataProcess from section 2 of MaxQuant output and 1) find the differentially abundant comparisons using <code>groupComparison</code> with the same <code>comparison</code> matrix, 2) draw volcano plot with output of <code>groupComparison</code>, and 3) draw comparison plot with output of <code>groupComparison</code> with MaxQuant output. and Check the comparison plot for the protein, <code>P55249</code>.</p>
</blockquote>
<details>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="dt">file=</span><span class="st">&#39;data/data_MaxQuant/quant.maxquant.rda&#39;</span>)

test.maxquant &lt;-<span class="st"> </span><span class="kw">groupComparison</span>(<span class="dt">contrast.matrix=</span>comparison, <span class="dt">data=</span>quant.maxquant)
MaxQuant.result &lt;-<span class="st"> </span>test.maxquant<span class="op">$</span>ComparisonResult
<span class="kw">write.csv</span>(MaxQuant.result, <span class="dt">file=</span><span class="st">&#39;data/data_MaxQuant/testResult_ABRF_maxquant.csv&#39;</span>)

<span class="kw">groupComparisonPlots</span>(<span class="dt">data =</span> MaxQuant.result, 
                     <span class="dt">type =</span> <span class="st">&#39;VolcanoPlot&#39;</span>,
                     <span class="dt">address =</span> <span class="st">&#39;data/data_MaxQuant/testResult_ABRF_maxquant_&#39;</span>)

<span class="kw">groupComparisonPlots</span>(<span class="dt">data =</span> MaxQuant.result, 
                     <span class="dt">type =</span> <span class="st">&#39;ComparisonPlot&#39;</span>,
                     <span class="dt">which.Protein =</span> <span class="st">&#39;P55249&#39;</span>,
                     <span class="dt">address =</span> <span class="st">&#39;data/data_MaxQuant/testResult_ABRF_maxquant_&#39;</span>)</code></pre>
</details>
<hr />
</div>
<div id="inference-and-future-design-of-experiment-with-openms-output" class="section level2">
<h2><span class="header-section-number">3.6</span> Inference and future design of experiment with OpenMS output</h2>
<blockquote>
<p>Challenges</p>
</blockquote>
<blockquote>
<p>Load the processed data (output of dataProcess from section 2 of OpenMS output and 1) find the differentially abundant comparisons using <code>groupComparison</code> with the same <code>comparison</code> matrix, 2) draw volcano plot with output of <code>groupComparison</code>, and 3) draw comparison plot with output of <code>groupComparison</code> with OpenMS output. and Check the comparison plot for the protein, <code>sp|P55249|ZRT4_YEAST</code>.</p>
</blockquote>
<details>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="dt">file=</span><span class="st">&#39;data/data_OpenMS/quant.openms.rda&#39;</span>)

test.openms &lt;-<span class="st"> </span><span class="kw">groupComparison</span>(<span class="dt">contrast.matrix=</span>comparison, <span class="dt">data=</span>quant.openms)
OpenMS.result &lt;-<span class="st"> </span>test.openms<span class="op">$</span>ComparisonResult
<span class="kw">write.csv</span>(OpenMS.result, <span class="dt">file=</span><span class="st">&#39;data/data_OpenMS/testResult_ABRF_openms.csv&#39;</span>)

<span class="kw">groupComparisonPlots</span>(<span class="dt">data =</span> MaxQuant.result, 
                     <span class="dt">type =</span> <span class="st">&#39;VolcanoPlot&#39;</span>,
                     <span class="dt">address =</span> <span class="st">&#39;data/data_OpenMS/testResult_ABRF_openms_&#39;</span>)

<span class="kw">groupComparisonPlots</span>(<span class="dt">data =</span> MaxQuant.result, 
                     <span class="dt">type =</span> <span class="st">&#39;ComparisonPlot&#39;</span>,
                     <span class="dt">which.Protein =</span> <span class="st">&#39;sp|P55249|ZRT4_YEAST&#39;</span>,
                     <span class="dt">address =</span> <span class="st">&#39;data/data_OpenMS/testResult_ABRF_openms_&#39;</span>)</code></pre>
</details>
<p>Here is the experimental design for ABRF 2015 study.
<img src="img/Protein_sample_information.png" alt="Summary of the ABRF 2015 study design, Choi, et al. J Proteome Res. 2017" style="width:70.0%" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day-1-section-2-msstats-data-processing-normalization-and-run-summarization.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/MayInst_P6_day1_sec3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
